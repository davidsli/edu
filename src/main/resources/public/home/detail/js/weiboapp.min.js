(function(k,e){var p=e.Event,r=e.DOM,f=e.extend,A=e.isNumber,F=e.isFunction,x=e.isString,m=e.isElement,u=e.isObject,C=e.arrayify,j=e.trim,w=r.addClass,o=function(){},t=k.document,z=e.query,B=function(E,D){var H=z(E,D);if(H&&H.length){return H[0]}return null},l=function(E){var D=E.cloneNode(true);if(ie<8){D.innerHTML=E.innerHTML}return D},y=function(E,D){var H=D.createElement("div");H.innerHTML=E;return H},c=function(D,I){if(D&&D.length){var J=null,E=0,H=D.length;I=I||D[0].ownerDocument;J=I.createDocumentFragment();if(D.item){D=C(D)}for(E=0,len=D.length;E<len;E++){J.appendChild(D[E])}return J}return null},h=function(I,H){if(typeof I==="string"&&(I=j(I))){var D=null,J,E=y;H=H||t;J=E(I,H).childNodes;if(J.length===1){D=J[0].parentNode.removeChild(J[0])}else{D=c(J,H)}return D}return null},a=Object.create?function(D,E){return Object.create(D,{constructor:{value:E}})}:function(E,I){function D(){}D.prototype=E;var H=new D();H.constructor=I;return H},v=function(J,L,I,M){if(!L||!J){return J}var E=L.prototype,D,H,K;D=a(E,J);J.prototype=f(D,J.prototype,true);J.superclass=a(E,L);if(I){f(D,I,true)}if(M){f(J,M,true)}return J},G="_sinaguid_"+(new Date()).getTime(),n={},g=function(E){if(!x(E)){E=""}var D="counter"+E;if(!n[D]){n[D]=0}n[D]++;return E+n[D]},d=function(I,D){var E=null;if(I){E=(typeof I==="string")?I:I[G];if(!E&&!D){try{I[G]=E=g()}catch(H){}}E=E||null}return E},q={},i={INIT:"init",INIT_END:"initend",RENDER:"render",RENDER_END:"renderend",DESTROY:"destroy",DESTROY_END:"destroyend"},s={render:null,source:null,width:"",height:""};function b(D){this.init.apply(this,arguments);var E=D&&D.render;if(E){if(E!==true){this.render(E)}else{this.render()}}}f(b.prototype,{WRAPPER_TAG:"div",CONTENT_TAG:"div",CSS_PREFIX:"sina-",_initialized:false,_destroyed:false,_rendered:false,init:function(D){D=D||{};this.trigger(i.INIT,{config:D});this._initAll(D);this._initialized=true;this.trigger(i.INIT_END)},destroy:function(){this.trigger(i.DESTROY);this._destroyAll();this.removeListener();this._destroyed=true;this.trigger(i.DESTROY_END)},_initAll:function(){if(!this._initialized){var I,H,E=this._inheritanceChain(),D;for(D=E.length-1;D>=0;D--){I=E[D];H=I.prototype;if(H.hasOwnProperty("initializer")){H.initializer.apply(this,arguments)}}}},_destroyAll:function(){if(!this._destroyed){var J,I,H=this._inheritanceChain(),E,D;for(E=0,D=H.length;E<D;E++){J=H[E];I=J.prototype;if(I.hasOwnProperty("destructor")){I.destructor.apply(this,arguments)}}}},initializer:function(D){var E=D.source;if(m(E)){this.contentBox=E}else{if(x(E)){this.contentBox=B(E)}else{this.contentBox=null}}this._width=D.width||"";this._height=D.height||""},destructor:function(){},render:function(E){this.trigger(i.RENDER,{container:E});if(x(E)){E=B(E)}else{if(!m(E)){E=null}}var L=E,D,K=this.contentBox,I=!K,M=t,N=this.constructor,J=this.WRAPPER_TAG,H=this.CONTENT_TAG;if(d(K,true)){return}d(K);this.elements={};this.wrapperBox=D=M.createElement(J);if(I){this.contentBox=K=M.createElement(H);D.appendChild(K)}else{K.parentNode.insertBefore(D,K);D.appendChild(K);this.queryElements()}if(L){if(L!==D.parentNode){L.insertBefore(D,L.firstChild)}}else{if(I){L=t.body;L.insertBefore(D,L.firstChild)}}this._renderAll();this._rendered=true;this.trigger(i.RENDER_END)},_renderAll:function(){if(this._initialized&&!this._rendered){var K,J,E=this._inheritanceChain(),D,L=this.CSS_PREFIX||"",H="",M=this.wrapperBox,I=this.contentBox;for(D=E.length-1;D>=0;D--){K=E[D];H=L+K.NAME;J=K.prototype;if(J.hasOwnProperty("renderer")){J.renderer.apply(this,arguments)}w(M,H)}w(I,H+"-content")}},renderer:function(){var I=this.wrapperBox,H=this.contentBox,E=this._width,D=this._height;if(!I||!H){return}if(A(E)){I.style.width=E+"px"}else{if(x(E)){I.style.width=E}}if(A(D)){I.style.height=D+"px"}else{if(x(D)){I.style.height=D}}},queryElements:function(){var D=this._getQueries(),E,I,H=this.contentBox,J=this.elements;for(E in D){I=B(D[E],H);if(I){J[E]=I}}},_getQueries:function(){var D={},H=this._inheritanceChain(),E,I;for(E=H.length-1;E>=0;E--){I=H[E]._queries;if(I){f(D,I,true)}}return D},_inheritanceChain:function(){if(!this.__chain){var D=[],E=this.constructor;while(E){D.push(E);E=E.superclass&&E.superclass.constructor}this.__chain=D}return this.__chain}});e.makeTarget(b);f(b,{NAME:"widget",guid:g,stamp:d});e.Widget=b;e.createWidget=function(I,D,H){if(!F(I)){H=D;D=I;I=b}H=H||{};D=D||{};var E=function(){E.superclass.constructor.apply(this,arguments)};v(E,I,D,H);return E}})(window,SINA);(function(e,b){if(e.Weibo&&e.Weibo.VERSION){return}var d=b.Widget,c=b.createWidget,a={VERSION:"0.1",guid:d.guid,stamp:d.stamp,createWidget:c};e.Weibo=a})(window,SINA);(function(i,d){var u=i.Weibo,w=d.arrayify,h=d.trim,r=d.isNumber,g=d.isArray,v=d.DOM,e=v.next,p=i.document,j=function(y){var x=y.cloneNode(true);if(ie<8){x.innerHTML=y.innerHTML}return x},q=function(y,x){var z=x.createElement("div");z.innerHTML=y;return z},c=function(x,A){if(x&&x.length){var B=null,y=0,z=x.length;A=A||x[0].ownerDocument;B=A.createDocumentFragment();if(x.item){x=w(x)}for(y=0,len=x.length;y<len;y++){B.appendChild(x[y])}return B}return null},f=function(A,z){if(typeof A==="string"&&(A=h(A))){var x=null,B,y=q;z=z||p;B=y(A,z).childNodes;if(B.length===1){x=B[0].parentNode.removeChild(B[0])}else{x=c(B,z)}return x}return null},o=function(x){return x.offsetParent?x.offsetLeft+o(x.offsetParent):x.offsetLeft},n=function(x){return x.offsetParent?x.offsetTop+n(x.offsetParent):x.offsetTop},m=(function(){var y=!!p.selection,A,x,z,B;if(y){A=function(C){C.focus();var D={text:"",start:0,end:0},E=0,F=p.selection.createRange(),G=p.body.createTextRange();G.moveToElementText(C);D.text=F.text;D.bookmark=F.getBookmark();for(;G.compareEndPoints("StartToStart",F)<0&&F.moveStart("character",-1)!==0;E++){if(C.value.charAt(E)=="\n"){E++}}D.start=E;D.end=D.text.length+D.start;return D};x=function(C,D){if(!D){this.toHead()}var E=C.createTextRange();if(C.value.length===D.start){E.collapse(false);E.select()}else{E.moveToBookmark(D.bookmark);E.select()}};z=function(C,D,F){var E;this.setPosition(C,D);E=p.selection.createRange();E.text=F;E.setEndPoint("StartToEnd",E);E.select()};B=function(C,E){var D=C.createTextRange();D.collapse(true);D.moveEnd("character",E);D.moveStart("character",E);D.select()}}else{A=function(C){C.focus();var D={text:"",start:0,end:0};D.start=C.selectionStart;D.end=C.selectionEnd;D.text=(D.start!==D.end)?C.value.substring(D.start,D.end):"";return D};x=function(C,D){if(!D){this.toHead(C);return}C.focus();C.setSelectionRange(D.start,D.end)};z=function(C,D,J){var F,G,H,I,E;this.setPosition(C,D);F=C.value;G=F.substring(0,D.start)+J+F.substring(D.end);H=I=D.start+J.length;E=C.scrollTop;C.value=G;if(C.scrollTop!=E){C.scrollTop=E}C.setSelectionRange(H,I)};B=function(C,D){C.focus();C.setSelectionRange(D,D)}}return{getPosition:A,setPosition:x,setText:z,moveTo:B,toHead:function(C){this.moveTo(C,0)},toTail:function(C){this.moveTo(C,C.value.length)}}})(),k=(function(){var x=(function(){var G=p.createElement("canvas");return"getContext" in G})(),y=1,z=2,C=440,E=Math.PI/2,F=[{M11:1,M12:0,M21:0,M22:1},{M11:0,M12:-1,M21:1,M22:0},{M11:-1,M12:0,M21:0,M22:-1},{M11:0,M12:1,M21:-1,M22:0}],D=function(L,I){if(!L){return}var N=L._angle||0,J=0,O=L.width,M=L.height,K=1,H=e(L),P,G;if(!H){H=f('<canvas class="'+(L.className||"")+'" style="display:none;"></canvas>');L.parentNode.insertBefore(H,null)}switch(I){case y:J=(N+3)%4;break;case z:J=(N+1)%4;break;default:if(N===0){return}break}P=H.getContext("2d");if(J===1||J===3){if(M>C){H.width=C;G=H.height=C/M*O;P.save();P.rotate(J*E);if(J===3){P.drawImage(L,-G,0,G,C)}else{P.drawImage(L,0,-C,G,C)}P.restore()}else{H.width=M;H.height=O;P.save();P.rotate(J*E);if(J===3){P.drawImage(L,-O,0)}else{P.drawImage(L,0,-M)}P.restore()}}else{H.width=O;H.height=M;P.save();P.rotate(J*E);if(J===2){P.drawImage(L,-O,-M)}else{P.drawImage(L,0,0)}P.restore()}L.style.display="none";H.style.display="inline";L._angle=J},B="DXImageTransform.Microsoft.Matrix",A=function(L,H){if(!L){return}var N=L._angle||0,K=0,Q=L.width,M=L.height,G,P,J=1,I="auto";switch(H){case y:K=(N+3)%4;break;case z:K=(N+1)%4;break;default:if(N===0){return}break}try{G=L.filters.item(B)}catch(O){L.style.filter="progid:"+B+'(SizingMethod="auto expand")';G=L.filters.item(B)}P=F[K];if(K===1||K===3){if(M>C){J=C/M}L.parentNode.style.height=(J*Q)+"px"}else{L.parentNode.style.height=M+"px"}G.M11=J*P.M11;G.M12=J*P.M12;G.M21=J*P.M21;G.M22=J*P.M22;L._angle=K};return{TURN_LEFT:y,TURN_RIGHT:z,MAX_IMG_WIDTH:C,DEG_90:E,ROTATE_MATRIX:F,mode:x?"canvas":"filter",rotateCanvas:D,rotateFilter:A,rotate90:x?D:A}})(),a=(function(){function x(D){if(!D){return -1}var E=D.slice(0,10)+D.slice(25)+D.slice(10,25);return Date.parse(E)||-1}function A(){var G=new Date(),I=G.getFullYear(),D=G.getMonth(),H=G.getDate(),E=new Date(I,D,H),F=new Date(I,0,1);return{now:G.getTime(),today:E.getTime(),thisYear:F.getTime()}}var B=A(),z=B.now,C=B.today,y=B.thisYear;return{getCurrent:A,timestamp:x,update:function(){var D=A();z=D.now;C=D.today;y=D.thisYear},displayString:function(G){G=parseInt(G,10)||0;if(!G){return"未知时间"}var F=Math.floor((z-G)/1000),D="",E;if(F<=10){D="10秒前"}else{if(F<=50){D=Math.ceil(F/10)*10+"秒前"}else{if(F<=3600){D=Math.round(F/60)+"分钟前"}else{if(G>C&&z-3600000>C){D="今天 "+(new Date(G)).toTimeString().substr(0,5)}else{if(G>y){E=new Date(G);D=(E.getMonth()+1)+"月"+E.getDate()+"日 "+E.toTimeString().substr(0,5)}else{E=new Date(G);D=E.getFullYear()+"-"+(E.getMonth()+1)+"-"+E.getDate()+" "+E.toTimeString().substr(0,5)}}}}}return D}}})(),l=function(x){var y=x.charAt(0);if(y=="#"){return'<a href="http://weibo.com/k/'+encodeURIComponent(x.slice(1,-1))+'" target="_blank">'+x+"</a>"}else{if(y=="@"){y=x.slice(5,7);if(y==":/"||y=="s:"){x=x.slice(1);return'@<a href="'+x+'" target="_blank">'+x+"</a>"}else{return'<a href="http://weibo.com/n/'+encodeURIComponent(x.slice(1))+'" target="_blank">'+x+"</a>"}}else{return'<a href="'+x+'"  target="_blank">'+x+"</a>"}}},t=/(?:#[^#]*#|@?http\s?\:\/\/[\w\.\/\-\%\?&\+]{4,}|\@[\w\-\u4e00-\u9fa5]+)/ig,s=function(x){return x.replace(t,l)},b={Textarea:m,Image:k,Time:a,cloneNode:j,createFromString:f,pageX:o,pageY:n,updateWordCount:function(z,B,E){if(!z||!B){return}E=E||0;var D=z.value||"",A=/[^x00-xff]/g,y=Math.round(D.replace(A,"aa").length/2),x=140,C;if((y+E)<=x){C=x-y-E;B.innerHTML="你还可以输入<em>"+C+"</em>字"}else{C=y-x+E;B.innerHTML='<span style="color:red">已经超出<em>'+C+"</em>字</span>"}},replaceStatusText:s};u.Utils=b})(window,SINA);(function(F,g){var e=F.document,c=e.documentElement,q=F.Weibo,B=q.Utils,f=g.Widget,l=g.Event,u=g.createWidget,w=g.extend,N=g.query,t=g.isNumber,J=g.DOM.style,b=l.addListener,A=l.removeListener,i=B.cloneNode,r=B.createFromString,M="weibo-",m="dialog",v=".",o=M+m+"-",s=o+"hd",n=o+"bd",h=o+"title",C=o+"close",y='<div class="',H='"></div>',I=y+s+H,G=y+n+H,L=y+h+H,K='<a title="关闭" class="'+C+'" href="javascript:void(0);">x</a>',a=o+"overlay-b",z=o+"overlay-p",d=y+a+H,k=y+z+H,x="show",D="hide",j="move",p=q.createWidget({CSS_PREFIX:M,initializer:function(P){var R,Q={},O=true,E=false,S=false;if(P){O=P.borderWidth||"";if(t(O)){O=O+"px"}E=!!P.overlay;display=P.display||"none";R=P.children;if(R){Q.title=R.title||"";Q.body=R.body||""}}this._borderWidth=O;this._hasOverlay=E;this._display=display;this._children=Q},destructor:function(){},renderer:function(){var P=this.wrapperBox,U=this.contentBox,Y=this.constructor,E=this.elements,S=E.header,T=E.body,X=E.title,Z=E.close,O,Q,W=this._borderWidth,R=this._children,V=this;P.style.position="absolute";U.style.position="relative";if(!S&&!T){S=r(I);T=r(G);X=r(L);Z=r(K);X.innerHTML=R.title||"";T.innerHTML=R.body||"";S.appendChild(X);S.appendChild(Z);U.appendChild(S);U.appendChild(T);E.header=S;E.title=X;E.close=Z;E.body=T}if(W){this.borderBox=O=r(d);O.style.position="absolute";O.style.left="-"+W;O.style.top="-"+W;P.insertBefore(O,U)}if(this._hasOverlay){this.overlayBox=Q=r(k);Q.style.position="absolute";Q.style.left=0;Q.style.top=0;P.parentNode.insertBefore(Q,P)}P.style.display=this._display;if(Q){Q.style.display=this._display}b(Z,"click",function(aa){V.hide();return false})},move:function(E,P){if(!this._rendered||this._destroyed){return}this.trigger(j,{x:E,y:P});var O=this.wrapperBox;if(t(E)){O.style.left=E+"px"}else{O.style.left=E}if(t(P)){O.style.top=P+"px"}else{O.style.top=P}},show:function(){if(!this._rendered||this._destroyed){return}this.trigger(x);var P=this.wrapperBox,O=this.overlayBox,E=this.borderBox;this._adjustSize();P.style.display="block";if(O){O.style.display="block"}},_adjustSize:function(){if(!this._rendered||this._destroyed){return}var S=this.wrapperBox,P=this.overlayBox,O=this.borderBox,R=parseInt(this._borderWidth)||0,E=parseInt(J(S,"width"))||0,Q=parseInt(J(S,"height"))||0;if(P){P.style.width=((c&&c.scrollWidth)||2000)+"px";P.style.height=((c&&c.scrollHeight)||2000)+"px"}if(O){O.style.width=(E+R*2)+"px";O.style.height=(Q+R*2)+"px"}},hide:function(){if(!this._rendered||this._destroyed){return}this.trigger(D);var O=this.wrapperBox,E=this.overlayBox;O.style.display="none";if(E){E.style.display="none"}},moveToPageCenter:function(){var E=this.wrapperBox,X=F.self,P=e.body,V,S,U,T,R,O,W,Q;U=X.pageXOffset||(c&&c.scrollLeft)||P.scrollLeft||0;T=X.pageYOffset||(c&&c.scrollTop)||P.scrollTop||0;R=X.innerWidth||(c&&c.clientWidth)||P.clientWidth||0;O=X.innerHeight||(c&&c.clientHeight)||P.clientHeight||0;W=parseInt(J(E,"width"))||0;Q=parseInt(J(E,"height"))||0;V=U+R/2-W/2;S=T+O/2-Q/2;if(V<0){V=0}if(S<0){S=0}this.move(V,S)}},{NAME:m,HEADER_TEMPLATE:I,BODY_TEMPLATE:G,CLOSE_TEMPLATE:K,TITLE_TEMPLATE:L,_queries:{header:v+s,body:v+n,title:v+h,close:v+C},_classNames:{header:s,body:n,title:h,close:C}});q.Dialog=p})(window,SINA);(function(L,h){var f=L.document,d=f.documentElement,u=L.Weibo,K=u.Utils,C=K.Textarea,o=K.cloneNode,w=K.createFromString,B=K.updateWordCount,y=h.extend,W=h.query,I=h.later,q=h.DOM,Q=q.style,t=q.attr,e=q.next,p=h.Event,c=p.addListener,J=p.removeListener,V="weibo-",r="retweet",x=".",a=" ",s=V+r+"-",U=s+"box",O=s+"quote",m=s+"form",i=s+"emoticons",A=s+"wordcount",g=s+"textarea",H=s+"options",M=s+"touser",v=s+"tooriginal",b=s+"user",z=s+"ouser",T=s+"actions",G=s+"submit",n=s+"cancel",k='<div class="',j='">',N="</div>",l=k+U+j+k+O+j+N+k+m+j+'<a class="'+i+'" href="javascript:void(0)" title="表情"></a>'+k+A+j+"还可以输入<em>140</em>个汉字"+N+'<textarea class="'+g+'"></textarea>'+k+H+j+'<p class="'+M+'"><input type="checkbox"> <label>同时评论给 <span class="'+b+'"></span></label></p><p class="'+v+'"><input type="checkbox"> <label>同时评论给原文作者 <span class="'+z+'"></span></label></p>'+N+N+k+T+j+'<a class="'+G+'" href="javascript:void(0);">转发</a><a class="'+n+'" href="javascript:void(0);">取消</a>'+N+N,F="submit",R="show-emoticons",P=u.createWidget(u.Dialog,{CSS_PREFIX:V,initializer:function(D){var E={};if(D){y(E,D.children)}this._children=E;this._wordCountTimer=null;this._textRange=null},renderer:function(ag){var ar=this,aa=ar.constructor,ab=ar.wrapperBox,an=ar.contentBox,ai=ar.elements,ao=ai.header,au=ai.title,ae=ai.body,aq=ai.quote,Y=ai.editor,af=ai.submit,aj,ah,at,ap,av,E,ac,am,X,al,D,ad,ak,S,Z=ar._children;if(!Y||!aq||!af){al=w(P.RT_TEMPLATE);ae.appendChild(al);ar.queryElements();aq=ai.quote;aj=ai.emoticons;ah=ai.tip;Y=ai.editor;at=ai.toUser;ap=ai.toUserCheckbox;av=ai.user;E=ai.toOriginal;ac=ai.toOriginalCheckbox;am=ai.original;af=ai.submit;X=ai.cancel;D=e(ap);ad=e(ac);S=(new Date()).getTime();ak="touser-"+S;ap.id=ak;t(D,"for",ak);ak="tooriginal-"+S;ac.id=ak;t(ad,"for",ak);if(Z.quote){aq.innerHTML=Z.quote}}c(Y,"keydown",function(aw){B(this,ah);aw.stopPropagation()});if(!ar._wordCountTimer){ar._lastText="";ar._wordCountTimer=I(function(){if(Y.value!==ar._lastText){B(Y,ah);ar._lastText=Y.value}},100,true)}c(aj,"click",function(aw){aw.preventDefault();ar._textRange=C.getPosition(Y);ar.trigger(R,{clickedElement:this});return false});c(af,"click",function(ax){ax.preventDefault();var ay=Y.value,az=ap.checked,aw=ac.checked;ar.trigger(F,{text:ay,commentToUser:az,commentToOriginal:aw})});c(X,"click",function(aw){ar.hide();return false})},show:function(){this.moveToPageCenter();this.constructor.superclass.show.call(this)},insertText:function(S,X){if(!this._rendered||this._destroyed){return}var E=this.elements.editor,D;if(X==="head"){C.toHead(E);D=C.getPosition(E);this._textRange=D}else{if(X==="tail"||!this._textRange){C.toTail(E);D=C.getPosition(E);this._textRange=D}else{D=this._textRange}}C.setText(E,D,S)},removeText:function(X){if(!this._rendered||this._destroyed){return}var D=this.elements.editor,S=D.value||"",E=this.elements.tip;if(X){D.value=S.replace(X,"")}else{D.value=""}},setQuote:function(D){if(!this._rendered||this._destroyed){return}this.elements.quote.innerHTML=D;if(Q(this.wrapperBox,"display")!=="none"){this._adjustSize()}},setOptions:function(ab,X){var D=this.elements,aa=D.toUser,ac=D.toUserCheckbox,S=D.user,Y=D.toOriginal,Z=D.toOriginalCheckbox,E=D.original;ac.checked=false;Z.checked=false;if(ab){aa.style.display="block";S.innerHTML=ab}else{aa.style.display="none"}if(X){Y.style.display="block";E.innerHTML=X}else{Y.style.display="none"}},focus:function(){if(!this._rendered||this._destroyed){return}C.toHead(this.elements.editor)},destructor:function(){}},{NAME:r,RT_TEMPLATE:l,_queries:{quote:x+O,emoticons:x+i,tip:x+A,editor:"textarea"+x+g,toUser:x+M,toUserCheckbox:x+M+a+"input",user:x+b,toOriginal:x+v,toOriginalCheckbox:x+v+a+"input",original:x+z,submit:x+G,cancel:x+n},_classNames:{}});u.RetweetDialog=P})(window,SINA);(function(z,h){var g=z.document,e=g.documentElement,s=z.Weibo,y=s.Utils,x=y.Textarea,i=y.Time,L=i.timestamp,d=i.displayString,t=y.createFromString,v=h.extend,O=h.query,M=h.isArray,o=h.DOM,G=o.children,n=h.Event,A=n.delegate,f=Array.prototype.splice,N="weibo-",p="commentlist",u=".",a=" ",q=N+p+"-",Q=q+"list",K=q+"item",b=q+"head",J=q+"feed",r=q+"text",j=q+"time",I=q+"actions",B=q+"reply",P=u+B,l='<div class="',k='">',C="</div>",w='<ol class="'+Q+'"></ol>',c="click-reply",H="http://weibo.com/",m=function(U){var S=[],R=U.id,D=U.text,W=U.created_at||0,E=U.user,Y=E.id,V=E.screen_name,X=E.verified,T=E.profile_image_url;T=T.replace("/50/","/30/");S.push('<li id="weibo-comment-');S.push(R);S.push('" class="');S.push(K);S.push(' weibo-clearfix"><a class="');S.push(b);S.push('" href="');S.push(H+Y);S.push('" title="');S.push(V);S.push('"><img src="');S.push(T);S.push('" title="');S.push(V);S.push('" /></a>');S.push('<div class="');S.push(J);S.push('"><p class="');S.push(r);S.push('"><a href="');S.push(H+Y);S.push('" title="');S.push(V);S.push('">');S.push(V);S.push("</a>：");S.push(D);S.push(' <span class="');S.push(j);S.push('">(');S.push(d(L(W)));S.push(')</span></p><div class="');S.push(I);S.push('"><a class="');S.push(B);S.push('" href="javascript:void(0)">回复</a>');S.push("</div></div></li>");return S.join("")},F=s.createWidget({CSS_PREFIX:N,initializer:function(E){var R={},S=[],D=10;if(E){D=E.capacity||D;v(R,E.children);S=E.data||S}this._capacity=D;this._comments=S;this._children=R},renderer:function(Y){var af=this,S=af.constructor,T=af.wrapperBox,ac=af.contentBox,ab=af.elements,ad=ab.list,ae,R,U,Z,V,W,aa,ag=af._comments,X,E=af._children,D=af._capacity;if(!ad){ad=t(F.LIST_TEMPLATE);ac.appendChild(ad);ab.list=ad}if(ag){if(D!==-1&&ag.length>D){ag=ag.slice(0,D)}X=F._buildList(ag);ad.innerHTML=X}A(ad,"click",P,function(al){var aj=O(P,ad),ah=aj.indexOf(this),ai=this,ak=af._comments[ah]||null;af.trigger(c,{index:ah,comment:ak,clickedElement:ai});return false})},length:function(){if(!this._rendered||this._destroyed){return 0}return(this._comments&&this._comments.length)||0},insert:function(R,T){if(!this._rendered||this._destroyed){return}T=parseInt(T)||0;var S=this._comments,D=this._capacity,E=this.elements.list;if(!M(R)){R=[R]}if(T===0){R=R.concat(S)}else{if(T>=this.length()){R=S.concat(R)}else{R.unshift(T,0);f.apply(S,R);R=S}}if(D!==-1&&R.length>D){R=R.slice(0,D)}this._comments=R;E.innerHTML=F._buildList(R)},append:function(D){this.insert(D,this.length())},prepend:function(D){this.insert(D,0)},remove:function(D){this.removeRange(D,D+1)},removeRange:function(S,D){if(!this._rendered||this._destroyed){return 0}S=S||0;D=D||this.length();var R=this._comments,E=this.elements.list;R.splice(S,D-S);E.innerHTML=F._buildList(R)},reset:function(R){var D=this._capacity,E=this.elements.list;if(M(R)){if(D!==-1&&R.length>D){R=R.slice(0,D)}this._comments=R;E.innerHTML=F._buildList(R)}},destructor:function(){}},{NAME:p,LIST_TEMPLATE:w,_queries:{list:u+Q},_classNames:{list:Q,item:K,head:b,feed:J,text:r,time:j,actions:I,reply:B},EVENTS:{REPLY:c},_buildList:function(T){var S=F._buildItem,R=[],E,D=(T&&T.length)||0;i.update();for(E=0;E<D;E++){R.push(S(T[E]))}return R.join("")},_buildItem:m});s.CommentList=F})(window,SINA);(function(N,i){var h=N.document,e=h.documentElement,u=N.Weibo,R=u.CommentList,M=u.Utils,F=M.Textarea,w=M.createFromString,y=i.extend,Y=i.query,K=i.later,W=i.isArray,q=i.DOM,T=q.children,f=q.next,t=q.attr,p=i.Event,d=p.addListener,O=p.delegate,X="weibo-",r="commentbox",v="http://img.t.sinajs.cn/t3/style/images/common/loading.gif",x=".",a=" ",s=X+r+"-",o=s+"form",Z=s+"list",B=s+"more",j=s+"loading",k=s+"emoticons",I=s+"submit",J=s+"options",c=s+"rt",n=s+"to",b=s+"user",m='<div class="',l='">',P="</div>",g=m+o+l+P,C=m+Z+l+P,Q=m+B+l+P,aa=m+j+l+'<img src="'+v+'" />'+P,H='<a href="javascript:void(0)" title="表情" class="'+k+'"></a>',L="<textarea></textarea>",U='<a href="javascript:void(0)" title="" class="'+I+' weibo-button">评论</a>',A=m+J+l+'<p class="'+c+'"><input type="checkbox" /><label>同时转发到我的微博</label></p><p class="'+n+'"><input type="checkbox" /><label>同时评论给原文作者 <span class="'+b+"</span></label></p>"+P,G="submit",V="show-emoticons",z=u.createWidget({CSS_PREFIX:X,initializer:function(E){var S={},ab=[],D=10;if(E){D=E.capacity||D;this._url=E.tweetUrl||"#";this._showToOriginal=E.showToOriginal||false;y(S,E.children);ab=E.data||ab}this._children=S;this._textRange=null;this._editorTimer=null;this._commentlist=new R({capacity:D,data:ab})},renderer:function(ak){var at=this,ae=at.constructor,af=at.wrapperBox,ao=at.contentBox,al=at.elements,D=al.form,aq=al.list,ab=al.editor,aj=al.submit,am=al.emoticons,ag,ac,ah,ar,S,ai,av,ap=at._commentlist,au=at._comments,ad=at._children,an,E;if(!D||!aq||!ab||!aj){D=w(z.FORM_TEMPLATE);aq=w(z.LIST_TEMPLATE);ag=w(z.MORE_TEMPLATE);ac=w(z.LOADING_TEMPLATE);D.innerHTML=z.EMOTICONS_TEMPLATE+z.EDITOR_TEMPLATE+z.SUBMIT_TEMPLATE+z.OPTIONS_TEMPLATE;ag.innerHTML='<a href="'+at._url+'" target="_blank" title="点击查看全部评论">点击查看全部评论 &gt;&gt;</a>';ao.appendChild(D);ao.appendChild(aq);ao.appendChild(ag);ao.appendChild(ac);at.queryElements();D=al.form;aq=al.list;ag=al.more;ac=al.loading;am=al.emoticons;ab=al.editor;aj=al.submit;ah=al.retweet;ar=al.retweetCheckbox;S=al.toOriginal;ai=al.toOriginalCheckbox;av=al.user;E=(new Date()).getTime();an="rt-"+E;ar.id=an;t(Y("label",ah)[0],"for",an);an="to-"+E;ai.id=an;t(Y("label",S)[0],"for",an)}if(at._showToOriginal){al.toOriginal.style.display="block"}else{al.toOriginal.style.display="none"}ap.render(aq);at._commentlist=ap;d(ap,R.EVENTS.REPLY,function(ay){var aC=ay.comment,aB=ab.value,aA,ax=/^\u56DE\u590D@[^\:]+\:/g,aw=aC.user&&aC.user.screen_name,az="回复@"+aw+":";aA=aB.replace(ax,az);if(aA===aB&&!aB.match(ax)){aA=az+aB}ab.value=aA;F.toTail(ab);return false});at._editorTimer=K(function(){ab.style.height="18px";var aw=18,ax=ab.scrollHeight;ax=Math.round(ax/aw)*aw;ab.style.height=ax+"px"},200,true);d(am,"click",function(aw){at._textRange=F.getPosition(ab);at.trigger(V,{clickedElement:this});return false});d(aj,"click",function(ay){ay.preventDefault();var az=ab.value,ax=al.retweetCheckbox.checked,aw=al.toOriginalCheckbox.checked;at.trigger(G,{text:az,retweet:ax,commentToOriginal:aw})})},reset:function(E,ac){if(!this._rendered||this._destroyed){return}var ab=this.elements,D=ab.toOriginal,S=ab.more;this._url=E;S.innerHTML='<a href="'+E+'" target="_blank" title="点击查看全部评论">点击查看全部评论 &gt;&gt;</a>';if(ac){D.style.display="block";this._showToOriginal=true}else{D.style.display="none";this._showToOriginal=false}},focus:function(){if(!this._rendered||this._destroyed){return}F.toHead(this.elements.editor)},setListData:function(D){if(!this._rendered||this._destroyed){return}this._commentlist.reset(D)},insertList:function(D,E){if(!this._rendered||this._destroyed){return}this._commentlist.insert(D,E)},insertText:function(S,ab){if(!this._rendered||this._destroyed){return}var E=this.elements.editor,D;if(ab==="head"){F.toHead(E);D=F.getPosition(E);this._textRange=D}else{if(ab==="tail"||!this._textRange){F.toTail(E);D=F.getPosition(E);this._textRange=D}else{D=this._textRange}}F.setText(E,D,S)},removeText:function(ab){if(!this._rendered||this._destroyed){return}var D=this.elements.editor,S=D.value||"",E=this.elements.tip;if(ab){D.value=S.replace(ab,"")}else{D.value=""}},toggleLoading:function(D){if(!this._rendered||this._destroyed){return}var ab=this.elements,S=ab.list,E=ab.more,ac=ab.loading;if(D){S.style.display="none";E.style.display="none";ac.style.display="block"}else{S.style.display="block";E.style.display="block";ac.style.display="none"}},destructor:function(){}},{NAME:r,FORM_TEMPLATE:g,LIST_TEMPLATE:C,MORE_TEMPLATE:Q,LOADING_TEMPLATE:aa,EMOTICONS_TEMPLATE:H,EDITOR_TEMPLATE:L,SUBMIT_TEMPLATE:U,OPTIONS_TEMPLATE:A,_queries:{form:x+o,list:x+Z,editor:x+o+" textarea",more:x+B,loading:x+j,emoticons:x+k,submit:x+I,retweet:x+c,retweetCheckbox:x+c+" input",toOriginal:x+n,toOriginalCheckbox:x+n+" input",user:x+b},_classNames:{form:o,more:B,loading:j,emoticons:k,submit:I,options:J,retweet:c,toOriginal:n,user:b},EVENTS:{SUBMIT:G,EMOTICONS:V}});u.CommentBox=z})(window,SINA);(function(l,d){var u=l.document,y=l.Weibo,b=y.Utils,z=y.CommentBox,f=y.Dialog,A=b.createFromString,e=d.extend,x=d.later,g=d.Array.forEach,r=d.DOM,p=d.Event,j=r.style,w=p.addListener,a="weibo-",t="commentpopup",v=".",m=" ",c=a+t+"-",q='<div class="',o='">',i="</div>",s=["insertText","removeText","focus","reset"],h=z.EVENTS,n=[h.SUBMIT,h.EMOTICONS],k=y.createWidget(y.Dialog,{CSS_PREFIX:a,initializer:function(B){var C={};if(B){e(C,B.children);C.title=C.title||"评论"}this._children=C;this._resizeTimer=null;this._metrics={}},destructor:function(){},renderer:function(){var F=this,I=F.wrapperBox,E=F.contentBox,D=F.constructor,G=F.elements,H=G.title,B=G.body,C=new z({capacity:-1,tweetUrl:"#",width:F._width-35});C.render(B);F._commentbox=C;g(s,function(J){F[J]=function(){C[J].apply(C,arguments)}});g(n,function(J){w(C,J,function(K){F.trigger(J,K)})});F._metrics.width=j(E,"width");F._metrics.height=j(E,"height");F._resizeTimer=x(function(){var L=F._metrics,J=j(E,"width"),K=j(E,"height");if(L.width!==J||L.height!==K){L.width=J;L.height=K;F._adjustSize()}},200,true)},show:function(){this.moveToPageCenter();this._commentbox.toggleLoading(true);this.constructor.superclass.show.call(this)},setListData:function(B){this._commentbox.setListData(B);this._commentbox.toggleLoading(false)}},{NAME:t,_queries:{},_classNames:{},EVENTS:{SHOW:"show",HIDE:"hide",MOVE:"move",SUBMIT:"submit",EMOTICONS:"show-emoticons"}});y.CommentPopup=k})(window,SINA);(function(i,d){var u=i.document,w=u.documentElement,A=i.Weibo,b=A.Utils,s=b.Textarea,m=b.cloneNode,F=b.createFromString,H=b.updateWordCount,e=d.extend,B=d.query,r=d.DOM,k=r.children,p=d.Event,I=p.delegate,z=p.addListener,h=p.removeListener,a="weibo-",t="emoticons",y=".",j=" ",c=a+t+"-",l=c+"list",x=c+"emoticon",G=a+"arrow",q='<div class="',o='">',g="</div>",f=q+l+" weibo-clearfix"+o+"<ul></ul>"+g,C=q+G+o,n="emoticon",v=A.createWidget(A.Dialog,{CSS_PREFIX:a,initializer:function(D){var E={},J={};if(D){e(E,D.children);e(J,D.data)}E.title=E.title||"常用表情";this._emoticons=J;this._children=E},renderer:function(J){var Q=this,S=Q.constructor,E=Q.wrapperBox,P=Q.contentBox,D=Q.elements,M=D.header,R=D.title,N=D.body,O=D.list,L=Q._emoticons,K=Q._children,T=function(V){var U=V.target,W=false;while(U&&U!==u){if(U===P){W=true;break}U=U.parentNode}if(!W){Q.hide();h(u,"click",T)}return false};M.insertBefore(F(C),R);if(!O){O=F(f);N.appendChild(O);D.list=O}Q.setEmoticons(L);I(O,"click",y+x+" a",function(V){var U=this.title;Q.trigger(n,{emoticon:U});Q.hide();return false});Q.addListener("hide",function(U){Q.removeListener(n);h(u,"click",T)});Q.addListener("show",function(U){z(u,"click",T)})},setEmoticons:function(M){var J=this,L=J.elements,K=L.list,E,D,N=[];E=k(K)[0];if(M){for(D in M){N.push('<li class="'+x+'"><a title="');N.push(D);N.push('" href="javascript:void(0)"><img src="');N.push(M[D]);N.push('" /></a></li>')}E.innerHTML=N.join("")}},destructor:function(){}},{NAME:t,_queries:{list:y+l},_classNames:{},EVENTS:{EMOTICON:n}});A.Emoticons=v})(window,SINA);(function(V,k){var i=V.document,e=i.documentElement,y=V.Weibo,T=y.Utils,O=T.Textarea,q=T.cloneNode,C=T.createFromString,K=T.updateWordCount,I=k.extend,ae=k.query,Q=k.later,b=k.trim,u=k.DOM,Y=u.style,x=u.attr,s=k.Event,d=s.addListener,R=s.removeListener,p=function(){},ad="weibo-",v="login",F=".",a=" ",w=ad+v+"-",c=w+"box",o=w+"form",X=w+"signup",f=w+"tip",r=w+"account",L=w+"password",aa=w+"remember",Z=w+"actions",P=w+"submit",af=w+"lostpwd",N="http://weibo.com/reg.php",M="http://login.sina.com.cn/member/getpwd/getpwd0.php?entry=sso",n='<div class="',m='">',W="</div>",H='<p class="',G='">',l="</p>",t=n+c+m+W,h=n+o+m+W,J=n+X+m+'还没有微博帐号？<a href="'+N+'" target="_blank">立即免费注册</a>'+W,ab=H+f+G+"您尚未登录新浪微博，请先登录"+l,B=H+r+G+'<label>邮箱/会员帐号/手机号:</label><br /><input type="text" />'+l,g=H+L+G+'<label>请输入密码:</label><br /><input type="password" />'+l,U=H+aa+G+'<input type="checkbox" checked="checked" /> <label>下次自动登录</label>'+l,z=H+Z+" weibo-clearfix"+G+'<a class="weibo-button '+P+'" href="javascript:void(0)">登录微博</a><a class="'+af+'" href="'+M+'" target="_blank">找回密码</a>'+l,ac="login",j="success",A="failure",ag=y.createWidget(y.Dialog,{CSS_PREFIX:ad,initializer:function(D){var E={},ah,S;if(D){I(E,D.children);E.title=E.title||"登录新浪微博";ah=D.onlogin||p;S=D.onlogout||p}this._children=E;this._onlogin=ah;this._onlogout=S},renderer:function(ar){var aA=this,ak=aA.constructor,al=aA.wrapperBox,ax=aA.contentBox,au=aA.elements,ay=au.header,aB=au.title,an=au.body,ap=au.loginbox,E=au.form,at=au.tip,ai=au.account,D=au.password,aq=au.remember,ao=au.submit,av,az,ah,am,aw,S,aj=aA._children;if(!ap||!ai||!D||!ao){ap=C(ag.LOGINBOX_TEMPLATE);E=C(ag.FORM_TEMPLATE);av=C(ag.SIGNUP_TEMPLATE);E.innerHTML=ag.TIP_TEMPLATE+ag.ACCOUNT_TEMPLATE+ag.PASSWORD_TEMPLATE+ag.REMEMBER_TEMPLATE+ag.ACTIONS_TEMPLATE;ap.appendChild(E);ap.appendChild(av);an.appendChild(ap);aA.queryElements();at=au.tip;ai=au.account;D=au.password;aq=au.remember;ao=au.submit;az=ae(F+r+" label",E)[0];ah=ae(F+L+" label",E)[0];am=ae(F+aa+" label",E)[0];S=(new Date()).getTime();aw="account-"+S;ai.id=aw;x(az,"for",aw);aw="password-"+S;D.id=aw;x(ah,"for",aw);aw="remember-"+S;aq.id=aw;x(am,"for",aw);if(aj.tip){at.innerHTML=aj.tip}}d(ao,"click",function(aF){var aD=b(ai.value),aC=D.value,aE=aq.checked;aA.trigger(ac,{account:aD,password:aC,remember:aE});return false})},show:function(){this.moveToPageCenter();this.constructor.superclass.show.call(this)},reset:function(ah,ai,ak){if(!this._rendered||this._destroyed){return}ah=ah||"";ai=ai||"";ak=ak||false;var S=this.elements,E=S.account,D=S.password,aj=S.remember;E.value=ah;D.value=ai;aj.checked=!!ak},setTip:function(D){if(!this._rendered||this._destroyed){return}this.elements.tip.innerHTML=D;this._adjustSize()},focus:function(){if(!this._rendered||this._destroyed){return}try{this.elements.account.focus()}catch(D){}},destructor:function(){}},{NAME:v,LOGINBOX_TEMPLATE:t,FORM_TEMPLATE:h,SIGNUP_TEMPLATE:J,TIP_TEMPLATE:ab,ACCOUNT_TEMPLATE:B,PASSWORD_TEMPLATE:g,REMEMBER_TEMPLATE:U,ACTIONS_TEMPLATE:z,_queries:{loginbox:F+c,form:F+o,tip:F+f,account:F+r+" input",password:F+L+" input",remember:F+aa+" input",submit:F+P},_classNames:{box:c,form:o,tip:f,account:r,password:L,remember:aa,actions:Z,submit:P,lostpwd:af,signup:X},EVENTS:{LOGIN:ac,SUCCESS:j,FAILURE:A}});y.LoginDialog=ag})(window,SINA);(function(j,h){var c=h.extend,k=h.arrayify,o=h.trim,b=!!j.postMessage,m=function(r){r=r||"";var q=(Math.random()+"").slice(2),p=(new Date()).getTime();return""+r+p+q},l=j.document,g=function(q){var p=q.cloneNode(true);if(ie<8){p.innerHTML=q.innerHTML}return p},d=function(q,p){var r=p.createElement("div");r.innerHTML=q;return r},i=function(p,s){if(p&&p.length){var t=null,q=0,r=p.length;s=s||p[0].ownerDocument;t=s.createDocumentFragment();if(p.item){p=k(p)}for(q=0,len=p.length;q<len;q++){t.appendChild(p[q])}return t}return null},f=function(s,r){if(typeof s==="string"&&(s=o(s))){var p=null,t,q=d;r=r||l;t=q(s,r).childNodes;if(t.length===1){p=t[0].parentNode.removeChild(t[0])}else{p=i(t,r)}return p}return null},n="http://api.sina.com.cn/script/javascript/postmsg.html",a="sina.com.cn",e={createNode:f,cloneNode:g,generateId:m,mode:b?"html5":"iframe",config:{proxyUrl:n,domain:a,form:null},setConfig:function(p){c(e.config,p,true)},send:b?function(p){var r=e.sender,q=e.config;if(!r){r=new e.Html5MsgSender({proxyUrl:q.proxyUrl});this.sender=r}r.send(p);return r}:function(p){var r,q=e.config;r=new e.IframeMsgSender({domain:q.domain,form:q.form});r.send(p);return r}};j.XDPost=e})(window,SINA);(function(i,h){var f=i.XDPost,b=h.extend,d=h.isFunction,c=document.addEventListener?function(o,n,m){if(o&&o.addEventListener){o.addEventListener(n,m,false)}}:function(o,n,m){if(o&&o.attachEvent){o.attachEvent("on"+n,m)}},l=document.removeEventListener?function(o,n,m){if(o&&o.removeEventListener){o.removeEventListener(n,m,false)}}:function(o,n,m){if(o&&o.detachEvent){o.detachEvent("on"+n,m)}},k=function(){},a=/^http\s?\:\/\/[a-z\d\-\.]+/i,g="sina-xdpost-iframe-",j=f.generateId,e=function(m){if(!(this instanceof e)){return new e(m)}m=m||{};this.init(m)};b(e.prototype,{ready:false,init:function(m){if(this.ready){return}var p=this,t,s,o,n,q,r=m.proxyUrl;p.onsuccess=m.onsuccess||k;p.onfailure=m.onfailure||k;if(!r){return}q=function(v){if(!p.ready||v.origin!==p.target){return}var u=v.data;if(!u||u==="failure"){p.onfailure&&p.onfailure()}else{p.onsuccess&&p.onsuccess(v.data)}};c(i,"message",q);t=j(g);s='<iframe id="'+t+'" name="'+t+'" src="'+r+'" frameborder="0" style="width:0;height:0;display:none;"></iframe>';o=f.createNode(s);n=function(){p.ready=true;var v=o.src,u=v.match(a);p.target=(u&&u[0])||"*"};c(o,"load",n);h.ready(function(){document.body.appendChild(o)});p._iframe=o;p._iframeLoaded=n;p._receiver=q},send:function(n){n=n||{};var p=this,o=n.url,r=n.data,m=n.onsuccess,q=n.onfailure;if(!o||typeof o!=="string"){return}if(m){p.onsuccess=m}if(q){p.onfailure=q}if(!p.ready){h.later(function(){p.send(n)},50);return}if(r){r+="&_url="+i.encodeURIComponent(o)}else{r="_url="+i.encodeURIComponent(o)}p._iframe.contentWindow.postMessage(r,p.target)},destroy:function(){var m=this._iframe;l(m,"load",this._iframeLoaded);m.parentNode.removeChild(m);l(i,"message",this._receiver);this._iframe=null;this._iframeLoaded=null;this._receiver=null}});f.Html5MsgSender=e})(window,SINA);(function(i,e){var d=i.XDPost,a=e.extend,m=e.ready,h=e.later,c=e.QueryString,g=c.parse,l=function(){},k="sina-xdpost-form-",f="sina-xdpost-iframe-",j=d.generateId,b=function(n){if(!(this instanceof b)){return new b(n)}n=n||{};this.init(n)};b.defaultDomain="sina.com.cn";a(b.prototype,{ready:false,init:function(n){if(this.ready){return}var p=this,s,r,u,t,o=n.form,q=n.domain||b.defaultDomain;p.onsuccess=n.onsuccess||l;p.onfailure=n.onfailure||l;if(!o){s=j(k);o=document.createElement("form");o.id=s;o.method="POST";m(function(){document.body.appendChild(o);p.ready=true})}t=function(v){p._clear();p.onsuccess&&p.onsuccess(v)};u=j("callback");i[u]=t;p.ready=e.isReady;p._callbackName=u;p._form=o;document.domain=q},send:function(u){u=u||{};var w=this,v,y,q,x,o,z,t=[],p=w._callbackName,n=u.url,r=u.data,A=u.onsuccess,s=u.onfailure;if(!n||typeof n!=="string"){return}if(A){w.onsuccess=A}if(s){w.onfailure=s}if(!w.ready){h(function(){w.send(u)},50);return}if(!(x=w._placeholder)){x=document.createElement("div");x.style.display="none";x.style.visibility="hidden";document.body.appendChild(x);w._placeholder=x}o=this._form;v=j(f);y='<iframe id="'+v+'" name="'+v+'" src="about:blank" frameborder="0" style="width:0;height:0;display:none;"></iframe>';this._iframeId=v;x.innerHTML=y;if(n.indexOf("?")===-1){o.action=n+"?callback="+p}else{o.action=n+"&callback="+p}o.target=v;if(r){if(typeof r==="string"){r=g(r)||{}}for(z in r){t.push('<input type="hidden" name="');t.push(z);t.push('" value="');t.push(r[z]);t.push('" />')}o.innerHTML=t.join("")}o.submit()},inProgress:function(){return !!(me._iframeId&&document.getElementById(me._iframeId))},_clear:function(){var n=this._iframeId&&document.getElementById(this._iframeId);if(n){n.parentNode.removeChild(n)}this._iframeId=null},cancel:function(){this._clear()},destroy:function(){var n=this._form,o=this._placeholder;n.parentNode.removeChild(n);o.parentNode.removeChild(o);this._form=null;this._placeholder=null;delete i[this._callbackName];this._iframeId=null}});d.IframeMsgSender=b})(window,SINA);(function(i,h){var g=i.XDPost,c=h.QueryString,k=h.JSON,a=h.extend,l=h.IO.getJSONP,m=h.UA.ie,j=function(){},f=function(r){r=r||{};var q=r.url,s=r.data||{},t=r.onsuccess||j,p=r.onfailure||j,o;if(!q||typeof q!=="string"){p({code:-10000003,msg:"接口 URL 未指定"});return}if(g.mode==="html5"){s=c.stringify(s);o=function(v){v=k.parse(v);var u=v&&v.result&&v.result.status;if(u&&u.code===0){t(v.result.data)}else{if(u){p(u)}else{p({code:-10000001,msg:"未知错误"})}}}}else{o=function(v){var u=v&&v.result&&v.result.status;if(u&&u.code===0){t(v.result.data)}else{if(u){p(u)}else{p({code:-10000001,msg:"未知错误"})}}};s.ie="gbk"}g.send({url:q,data:s,onsuccess:o,onfailure:j})},e=function(q){q=q||{};var p=q.url,r=q.data||{},s=q.onsuccess||j,o=q.onfailure||j;if(!p||typeof p!=="string"){o({code:-10000003,msg:"接口 URL 未指定"});return}l(p,c.stringify(r),function(u){var t=u&&u.result&&u.result.status;if(t&&t.code===0){s(u.result.data)}else{if(t){o(t)}else{o({code:-10000001,msg:"未知错误"})}}})},b="http://api.sina.com.cn/weibo/",d=m?"xml":"json",n={_get:e,_post:f,apis:{getComments:b+"statuses/comments.json",getEmoticons:b+"emotions.json",comment:b+"statuses/comment."+d,repost:b+"statuses/repost."+d,favorite:b+"favorites/create."+d,follow:b+"friendships/create."+d,batchFollow:b+"wb/friendships_create."+d,update:b+"statuses/update."+d,isFollowing:b+"wb/friendships_exists.json",appKey:"1264902108"},config:function(o){a(this.apis,o,true)},getComments:function(q){q=q||{};var o=q.url,p=this.apis;if(!o){o=p.getComments}if(o.indexOf("?")>=0){o+="&source="+p.appKey}else{o+="?source="+p.appKey}q.url=o;e(q)},getEmoticons:function(q){q=q||{};var o=q.url,p=this.apis;if(!o){o=p.getEmoticons}if(o.indexOf("?")>=0){o+="&source="+p.appKey}else{o+="?source="+p.appKey}q.url=o;e(q)},update:function(q){q=q||{};var o=q.url,p=this.apis;if(!o){o=p.update}if(o.indexOf("?")>=0){o+="&source="+p.appKey}else{o+="?source="+p.appKey}q.url=o;f(q)},repost:function(q){q=q||{};var o=q.url,p=this.apis;if(!o){o=p.repost}if(o.indexOf("?")>=0){o+="&source="+p.appKey}else{o+="?source="+p.appKey}q.url=o;f(q)},comment:function(q){q=q||{};var o=q.url,p=this.apis;if(!o){o=p.comment}if(o.indexOf("?")>=0){o+="&source="+p.appKey}else{o+="?source="+p.appKey}q.url=o;f(q)},favorite:function(q){q=q||{};var o=q.url,p=this.apis;if(!o){o=p.favorite}if(o.indexOf("?")>=0){o+="&source="+p.appKey}else{o+="?source="+p.appKey}q.url=o;f(q)},follow:function(q){q=q||{};var o=q.url,p=this.apis;if(!o){o=p.follow}if(o.indexOf("?")>=0){o+="&source="+p.appKey}else{o+="?source="+p.appKey}q.url=o;f(q)},batchFollow:function(q){q=q||{};var o=q.url,p=this.apis;if(!o){o=p.batchFollow}if(o.indexOf("?")>=0){o+="&source="+p.appKey}else{o+="?source="+p.appKey}q.url=o;f(q)},isFollowing:function(q){q=q||{};var o=q.url,p=this.apis;if(!o){o=p.isFollowing}if(o.indexOf("?")>=0){o+="&source="+p.appKey}else{o+="?source="+p.appKey}q.url=o;e(q)}};i.WeiboComm=n})(window,SINA);(function(g,e){var n=g.Weibo,l=n.LoginDialog,m=e.Event,a=e.extend,b=m.addListener,k=m.removeListener,j=function(){},i="sinaSSOManager",h="未载入 SSO 模块",f={isLoggedIn:function(){var p=g[i],o;if(!p){alert(h);return false}o=p.getSinaCookie();if(o&&o.name&&o.bt){return true}return false},loginStatus:function(){var p=g[i],o;if(!p){alert(h);return 0}o=p.getSinaCookie();if(o){if(o.name&&o.bt){return 1}return 2}return 0},login:function(o,p,q){if(!g[i]){alert(h);return}if(!o||!p){return}q=q||j;g[i].login(q,o,p)},logout:function(o){if(!g[i]){alert(h);return}o=o||j;g[i].logout(o)},getUserInfo:function(){if(!g[i]){alert(h);return null}return g[i].getSinaCookie()}},c=null,d={isLoggedIn:f.isLoggedIn,execAfterLogin:function(p){var r=g[i],o,q=function(s){if(d.onlogin){d.onlogin(s)}if(p){p(s)}};if(!r){alert(h);return}o=r.getSinaCookie();if(o){if(o.name&&o.bt){q(o)}else{r.autoLogin(function(s){if(s&&s.uid){q(o)}else{if(d.dialog){d.onsuccess=q;d.dialog.show()}else{alert("请先登录")}}})}}else{if(d.dialog){d.ondialogshow&&d.ondialogshow();d.onsuccess=q;d.dialog.show()}else{alert("请先登录")}}},ondialogshow:null,onsuccess:null,onlogin:null,dialog:c};e.ready(function(){var o=l.EVENTS.LOGIN,p=l.EVENTS.SUCCESS;c=new l({borderWidth:5,overlay:true,width:350});c.render(document.body);b(c,o,function(t){var q=this,r=t.account,s=t.password,u=t.remember;if(!r){c.setTip('<span style="color:red">用户名不能为空</span>');return}if(!s){c.setTip('<span style="color:red">密码不能为空</span>');return}f.login(r,s,function(v){if(v&&v.result){c.hide();if(d.onsuccess){var w=f.getUserInfo();d.onsuccess(v)}}else{var x=(v&&v.reason)||"未知错误";c.setTip('<span style="color:red">'+x+"</span>")}})});d.dialog=c});g.WeiboLogin=d})(window,SINA);(function(n,g){if(!n.WeiboApp){n.WeiboApp={}}var B=n.WeiboApp,e=n.WeiboComm,x=n.Weibo,y=n.WeiboLogin,d=x.Utils,b=x.RetweetDialog,o=x.CommentPopup,u=d.pageX,t=d.pageY,p=d.cloneNode,z=d.createFromString,k=y.execAfterLogin,h=g.extend,l=g.isArray,s=g.DOM,j=s.style,c=s.cache,r=g.Event,w=r.addListener,i=r.removeListener,a="http://timg.sjs.sinajs.cn/t3/style/images/common/face/basic/",q="sinaSSOManager",A="未载入 SSO 模块",m,f,v;h(B,{_retweetDialog:null,_commentDialog:null,_emoticonsDialog:null,ready:false,retweet:function(G,D,F,C,E){if(!this.ready){return}k(function(){if(!m._cache){m._cache={}}D=unescape(D);F=unescape(F);m._cache.id=G;m.setQuote(D);m.setOptions(C,E);m.show();m.removeText();m.insertText(F);m.focus()})},showComments:function(F,D,C,E){if(!this.ready){return}F=F||0;D=D||0;C=C||0;E=E||3;k(function(){if(!f._cache){f._cache={}}f._cache.id=F;f.reset("http://weibo.com/"+D+"/"+C);f.removeText();f.show();f.focus();e.getComments({data:{id:F,count:E},onsuccess:function(G){f.setListData(G)},onfailure:function(G){f.setListData([])}})})},FOLLOWED:'<a class="concernBtn_Yet" href="javascript:void(0)"><span class="add_yet"></span>已关注</a>',follow:function(D,C){if(!D||!C){return}k(function(){e.follow({data:{user_id:D},onsuccess:function(G){var E=z(B.FOLLOWED),F=C.parentNode;F.insertBefore(E,C);F.removeChild(C)},onfailure:function(F){var G=parseInt(F.msg.slice(0,5))||0;if(G===40303){var E=z(B.FOLLOWED),H=C.parentNode;H.insertBefore(E,C);H.removeChild(C)}else{alert(F.msg)}}})})},onfollow:null,batchFollow:function(C){if(!C||!C.length){return}k(function(){var F=n[q],E,D;E=F&&F.getSinaCookie();D=(E&&E.uid)||0;if(!l(C)){C=[C]}e.batchFollow({data:{uid:D,uids:C.join(",")},onsuccess:function(G){B.onfollow&&B.onfollow(G)},onfailure:function(G){alert("关注失败："+G.msg)}})})},isFollowing:function(G,F){var E=n[q],D,C;D=E&&E.getSinaCookie();C=(D&&D.uid)||0;if(l(G)){G=G.join(",")}e.isFollowing({data:{uid:C,uids:G},onsuccess:function(H){F&&F(H)}})},FAVED:"<strong>已收藏</strong>",favorite:function(D,C){if(!D||!C){return}k(function(){e.favorite({data:{id:D},onsuccess:function(G){var E=z(B.FAVED),F=C.parentNode;F.insertBefore(E,C);F.removeChild(C)},onfailure:function(E){alert(E.msg)}})})},emoticons:{"足球":a+"football.gif","哨子":a+"shao.gif","红牌":a+"redcard.gif","黄牌":a+"yellowcard.gif","哈哈":a+"laugh.gif","呵呵":a+"smile.gif","衰":a+"cry.gif","汗":a+"sweat.gif","爱你":a+"love.gif","嘻嘻":a+"tooth.gif","哼":a+"hate.gif","心":a+"heart.gif","晕":a+"dizzy.gif","怒":a+"angry.gif","蛋糕":a+"cake.gif","花":a+"flower.gif","抓狂":a+"crazy.gif","困":a+"sleepy.gif","干杯":a+"cheer.gif","太阳":a+"sun.gif","下雨":a+"rain.gif","泪":a+"sad.gif","月亮":a+"moon.gif","猪头":a+"pig.gif","蜡烛":a+"candle.gif","伤心":a+"unheart.gif","风扇":a+"fan.gif","冰棍":a+"ice.gif","西瓜":a+"watermelon.gif"}});g.ready(function(){var C="show-emoticons",D="emoticon",E="submit",F=function(I){var H=I.clickedElement,G=u(H)-12,J=t(H)+(parseInt(j(H,"height"))||0)+5;v.move(G,J);v.show()};m=new b({children:{title:"转发到我的微博"},width:500,borderWidth:5,overlay:true});f=new o({width:500,borderWidth:5,overlay:true});v=new x.Emoticons({width:310,borderWidth:5,data:B.emoticons});m.render(document.body);f.render(document.body);v.render(document.body);m.addListener(C,function(G){F(G);v.addListener(D,function(H){var I="["+H.emoticon+"] ";m.insertText(I);v.removeListener(D)})});f.addListener(C,function(G){F(G);v.addListener(D,function(H){var I="["+H.emoticon+"] ";f.insertText(I);v.removeListener(D)})});m.addListener(E,function(G){y.ondialogshow=function(){m.hide()};k(function(){var H=0;if(G.commentToUser){H+=1}if(G.commentToOriginal){H+=2}e.repost({data:{id:m._cache.id,status:G.text,is_comment:H},onsuccess:function(I){m.hide();alert("转发成功")},onfailure:function(I){alert(I.msg)}})})});f.addListener(E,function(G){y.ondialogshow=function(){f.hide()};k(function(){if(!G.retweet){e.comment({data:{id:f._cache.id,comment:G.text,comment_ori:G.commentToOriginal},onsuccess:function(I){f.hide();alert("评论成功")},onfailure:function(I){alert(I.msg)}})}else{var H=1;if(G.commentToOriginal){H+=2}e.repost({data:{id:f._cache.id,status:G.text,is_comment:H},onsuccess:function(I){f.hide();alert("评论成功")},onfailure:function(I){alert(I.msg)}})}})});B._retweetDialog=m;B._commentDialog=f;B._emoticonsDialog=v;B.ready=true})})(window,SINA);