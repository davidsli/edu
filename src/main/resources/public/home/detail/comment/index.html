<meta charset="utf-8">
<link  rel="stylesheet" href="comment/css/main.css" />
<link rel="stylesheet" type="text/css" href="comment/css/sinaFaceAndEffec.css" />
<script type="text/javascript" src="comment/js/jquery-1.8.3.min.js"></script>

<div id="content" style="width: 80%; height: auto;margin-left:10px;margin-top:20px">
	<div class="wrap">
		<div class="comment">
			<div class="head-face">
				<img src="comment/images/1.jpg" />
				<p>我是鸟</p>
			</div>
			<div class="content" style="width: 80%;margin-left:1px;">
				<div class="cont-box" style="width: 80%">
					<textarea class="text"  placeholder="请输入..."></textarea>
				</div>
				<div class="tools-box" style="width: 80%">
					<div class="operator-box-btn"><span class="face-icon"  >☺</span></div>
					<div class="submit-btn"><input type="button" onClick="out()"value="提交评论" /></div>
				</div>
			</div>
		</div>
		<div id="info-show">
			<ul></ul>
		</div>
	</div>
</div>

<script type="text/javascript" src="comment/js/main.js"></script>
<script type="text/javascript" src="comment/js/sinaFaceAndEffec.js"></script>
<script type="text/javascript">
//初始化用户的评论界面
$(function(){
	$.ajax({
		url:"/home/detail/comment/list",
		data:{"videoId":$("#videoId").val()},
		type:"post",
		dataType:"json",
		success:function(data){
			if(data.success==true){
				$.each(data.comList,function(index,ls){
					$('#info-show ul').append(
							 '<li>'+
							 	'<div class="head-face">'+
							 		'<img src="comment/images/1.jpg" / >'+
							 	'</div>'+
							 	'<div class="reply-cont">'+
							 		'<p class="username">'+ls.nickName+'</p>'+
							 		'<p class="comment-body">'+ls.content+'</p>'+
							 		'<p class="comment-footer">'+ls.comTime+'　回复　点赞54　转发12</p>'+
							 	'</div>'+
							 '</li>'
					);
				})
			}
			else{
				$.alert("处理请求出错","提示");
			}
		 }
		
		})
})
	// 绑定表情
	$('.face-icon').SinaEmotion($('.text'));
	// 测试本地解析
	function out() {
		var inputText = $('.text').val();
		var comment=AnalyticEmotion(inputText);
		if(comment.length<1)
		{
		   alert("评论不能为空");
		   return false;
		}
		if(comment.length>498)
		{
		   alert("评论不能太长");
		   return false;
		}
		$.ajax({
			url:"/home/detail/comment/add",
			data:{"videoId":$("#videoId").val(),"content":comment},
			type:"post",
			dataType:"json",
			success:function(data){
				if(data.success==true)
				{
					$("#contentWap").empty();
					$("#contentWap").load("/home/detail/comment/index");
				}
				else{
					$.alert("处理请求出错","提示");
				}
			}
			})
	}
	
	var html;
	function reply(content){
		html  = '<li>';
		html += '<div class="head-face">';
		html += '<img src="comment/images/1.jpg" / >';
		html += '</div>';
		html += '<div class="reply-cont">';
		html += '<p class="username">小小红色飞机</p>';
		html += '<p class="comment-body">'+content+'</p>';
		html += '<p class="comment-footer">2016年10月5日　回复　点赞54　转发12</p>';
		html += '</div>';
		html += '</li>';
		return html;
	}
</script>



